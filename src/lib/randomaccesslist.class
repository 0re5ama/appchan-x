class RandomAccessList
  constructor: ->
    @first = null
    @last = null
    @length = 0

  push: (id, post) ->
    {last} = @
    @[id] = item = post
    item.prev = last
    item.next = null
    @last = item
    if last
      last.next = item
    else
      @first = item
    @length++

  shift: ->
    @rm @first.ID

  after: (root, item) ->
    return if item.prev is root

    @rmi item

    {next} = root

    root.next = item
    item.prev = root
    item.next = next
    next.prev = item

  rm: (id) ->
    item = @[id]
    return unless item
    delete @[id]
    @length--
    @rmi item

  rmi: (item) ->
    {prev, next} = item
    if prev
      prev.next = next
    else
      @first = next
    if next
      next.prev = prev
    else
      @last = prev